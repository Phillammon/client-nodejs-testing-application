/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("grakn-client/concept/proto/ConceptProtoReader", ["require", "exports", "graknlabs-grpc-protocol/protobuf/concept_pb", "assert", "grakn-client/dependencies_internal"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.ConceptProtoReader = void 0;
    // TODO: Can we get rid of this?
    const concept_pb_1 = __importDefault(require("graknlabs-grpc-protocol/protobuf/concept_pb"));
    const assert_1 = __importDefault(require("assert"));
    const dependencies_internal_1 = require("grakn-client/dependencies_internal");
    var ConceptProtoReader;
    (function (ConceptProtoReader) {
        // This method cannot live in ThingImpl itself, because doing so creates a circular class reference
        // [ThingImpl -> EntityImpl -> ThingImpl] which causes a JavaScript runtime error
        function thing(thingProto) {
            switch (thingProto.getEncoding()) {
                case concept_pb_1.default.Thing.ENCODING.ENTITY:
                    return dependencies_internal_1.EntityImpl.of(thingProto);
                case concept_pb_1.default.Thing.ENCODING.RELATION:
                    return dependencies_internal_1.RelationImpl.of(thingProto);
                case concept_pb_1.default.Thing.ENCODING.ATTRIBUTE:
                    return attribute(thingProto);
                default:
                    throw "Bad encoding";
            }
        }
        ConceptProtoReader.thing = thing;
        function attribute(thingProto) {
            switch (thingProto.getValueType()) {
                case concept_pb_1.default.AttributeType.VALUE_TYPE.BOOLEAN:
                    return dependencies_internal_1.BooleanAttributeImpl.of(thingProto);
                case concept_pb_1.default.AttributeType.VALUE_TYPE.LONG:
                    return dependencies_internal_1.LongAttributeImpl.of(thingProto);
                case concept_pb_1.default.AttributeType.VALUE_TYPE.DOUBLE:
                    return dependencies_internal_1.DoubleAttributeImpl.of(thingProto);
                case concept_pb_1.default.AttributeType.VALUE_TYPE.STRING:
                    return dependencies_internal_1.StringAttributeImpl.of(thingProto);
                case concept_pb_1.default.AttributeType.VALUE_TYPE.DATETIME:
                    return dependencies_internal_1.DateTimeAttributeImpl.of(thingProto);
                default:
                    throw "Bad value type";
            }
        }
        ConceptProtoReader.attribute = attribute;
        function type(typeProto) {
            switch (typeProto.getEncoding()) {
                case concept_pb_1.default.Type.ENCODING.ROLE_TYPE:
                    return dependencies_internal_1.RoleTypeImpl.of(typeProto);
                default:
                    return thingType(typeProto);
            }
        }
        ConceptProtoReader.type = type;
        function thingType(typeProto) {
            switch (typeProto.getEncoding()) {
                case concept_pb_1.default.Type.ENCODING.ENTITY_TYPE:
                    return dependencies_internal_1.EntityTypeImpl.of(typeProto);
                case concept_pb_1.default.Type.ENCODING.RELATION_TYPE:
                    return dependencies_internal_1.RelationTypeImpl.of(typeProto);
                case concept_pb_1.default.Type.ENCODING.ATTRIBUTE_TYPE:
                    return attributeType(typeProto);
                case concept_pb_1.default.Type.ENCODING.THING_TYPE:
                    assert_1.default(typeProto.getRoot());
                    return new dependencies_internal_1.ThingTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                default:
                    throw "Bad encoding";
            }
        }
        ConceptProtoReader.thingType = thingType;
        function attributeType(typeProto) {
            switch (typeProto.getValueType()) {
                case concept_pb_1.default.AttributeType.VALUE_TYPE.BOOLEAN:
                    return new dependencies_internal_1.BooleanAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                case concept_pb_1.default.AttributeType.VALUE_TYPE.LONG:
                    return new dependencies_internal_1.LongAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                case concept_pb_1.default.AttributeType.VALUE_TYPE.DOUBLE:
                    return new dependencies_internal_1.DoubleAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                case concept_pb_1.default.AttributeType.VALUE_TYPE.STRING:
                    return new dependencies_internal_1.StringAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                case concept_pb_1.default.AttributeType.VALUE_TYPE.DATETIME:
                    return new dependencies_internal_1.DateTimeAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                case concept_pb_1.default.AttributeType.VALUE_TYPE.OBJECT:
                    assert_1.default(typeProto.getRoot());
                    return new dependencies_internal_1.AttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
                default:
                    throw "Bad value type";
            }
        }
        ConceptProtoReader.attributeType = attributeType;
    })(ConceptProtoReader = exports.ConceptProtoReader || (exports.ConceptProtoReader = {}));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29uY2VwdFByb3RvUmVhZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vY29uY2VwdC9wcm90by9Db25jZXB0UHJvdG9SZWFkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBaUJHOzs7Ozs7Ozs7Ozs7Ozs7O0lBRUgsZ0NBQWdDO0lBRWhDLDZGQUF1RTtJQUN2RSxvREFBNEI7SUFDNUIsOEVBcUJxQztJQUVyQyxJQUFpQixrQkFBa0IsQ0E2RWxDO0lBN0VELFdBQWlCLGtCQUFrQjtRQUMvQixtR0FBbUc7UUFDbkcsaUZBQWlGO1FBQ2pGLFNBQWdCLEtBQUssQ0FBQyxVQUE4QjtZQUNoRCxRQUFRLFVBQVUsQ0FBQyxXQUFXLEVBQUUsRUFBRTtnQkFDOUIsS0FBSyxvQkFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTTtvQkFDbkMsT0FBTyxrQ0FBVSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDckMsS0FBSyxvQkFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUTtvQkFDckMsT0FBTyxvQ0FBWSxDQUFDLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDdkMsS0FBSyxvQkFBWSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsU0FBUztvQkFDdEMsT0FBTyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ2pDO29CQUNJLE1BQU0sY0FBYyxDQUFDO2FBQzVCO1FBQ0wsQ0FBQztRQVhlLHdCQUFLLFFBV3BCLENBQUE7UUFFRCxTQUFnQixTQUFTLENBQUMsVUFBOEI7WUFDcEQsUUFBUSxVQUFVLENBQUMsWUFBWSxFQUFFLEVBQUU7Z0JBQy9CLEtBQUssb0JBQVksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLE9BQU87b0JBQzlDLE9BQU8sNENBQW9CLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2dCQUMvQyxLQUFLLG9CQUFZLENB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QVMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztnQkFDbEYsS0FBSyxvQkFBWSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsUUFBUTtvQkFDL0MsT0FBTyxJQUFJLGlEQUF5QixDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztnQkFDcEYsS0FBSyxvQkFBWSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsTUFBTTtvQkFDN0MsZ0JBQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztvQkFDNUIsT0FBTyxJQUFJLHlDQUFpQixDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztnQkFDNUU7b0JBQ0ksTUFBTSxnQkFBZ0IsQ0FBQzthQUM5QjtRQUNMLENBQUM7UUFsQmUsZ0NBQWEsZ0JBa0I1QixDQUFBO0lBQ0wsQ0FBQyxFQTdFZ0Isa0JBQWtCLEdBQWxCLDBCQUFrQixLQUFsQiwwQkFBa0IsUUE2RWxDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8vIFRPRE86IENhbiB3ZSBnZXQgcmlkIG9mIHRoaXM/XG5cbmltcG9ydCBDb25jZXB0UHJvdG8gZnJvbSBcImdyYWtubGFicy1ncnBjLXByb3RvY29sL3Byb3RvYnVmL2NvbmNlcHRfcGJcIjtcbmltcG9ydCBhc3NlcnQgZnJvbSBcImFzc2VydFwiO1xuaW1wb3J0IHtcbiAgICBBdHRyaWJ1dGVUeXBlSW1wbCxcbiAgICBCb29sZWFuQXR0cmlidXRlVHlwZUltcGwsXG4gICAgRGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbCxcbiAgICBEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCxcbiAgICBMb25nQXR0cmlidXRlVHlwZUltcGwsXG4gICAgU3RyaW5nQXR0cmlidXRlVHlwZUltcGwsXG4gICAgVGhpbmdJbXBsLFxuICAgIEVudGl0eUltcGwsXG4gICAgUmVsYXRpb25JbXBsLFxuICAgIEF0dHJpYnV0ZUltcGwsXG4gICAgQm9vbGVhbkF0dHJpYnV0ZUltcGwsXG4gICAgRGF0ZVRpbWVBdHRyaWJ1dGVJbXBsLFxuICAgIERvdWJsZUF0dHJpYnV0ZUltcGwsXG4gICAgTG9uZ0F0dHJpYnV0ZUltcGwsXG4gICAgU3RyaW5nQXR0cmlidXRlSW1wbCxcbiAgICBUeXBlSW1wbCxcbiAgICBUaGluZ1R5cGVJbXBsLFxuICAgIFJvbGVUeXBlSW1wbCxcbiAgICBFbnRpdHlUeXBlSW1wbCxcbiAgICBSZWxhdGlvblR5cGVJbXBsLFxufSBmcm9tIFwiLi4vLi4vZGVwZW5kZW5jaWVzX2ludGVybmFsXCI7XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ29uY2VwdFByb3RvUmVhZGVyIHtcbiAgICAvLyBUaGlzIG1ldGhvZCBjYW5ub3QgbGl2ZSBpbiBUaGluZ0ltcGwgaXRzZWxmLCBiZWNhdXNlIGRvaW5nIHNvIGNyZWF0ZXMgYSBjaXJjdWxhciBjbGFzcyByZWZlcmVuY2VcbiAgICAvLyBbVGhpbmdJbXBsIC0+IEVudGl0eUltcGwgLT4gVGhpbmdJbXBsXSB3aGljaCBjYXVzZXMgYSBKYXZhU2NyaXB0IHJ1bnRpbWUgZXJyb3JcbiAgICBleHBvcnQgZnVuY3Rpb24gdGhpbmcodGhpbmdQcm90bzogQ29uY2VwdFByb3RvLlRoaW5nKTogVGhpbmdJbXBsIHtcbiAgICAgICAgc3dpdGNoICh0aGluZ1Byb3RvLmdldEVuY29kaW5nKCkpIHtcbiAgICAgICAgICAgIGNhc2UgQ29uY2VwdFByb3RvLlRoaW5nLkVOQ09ESU5HLkVOVElUWTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRW50aXR5SW1wbC5vZih0aGluZ1Byb3RvKTtcbiAgICAgICAgICAgIGNhc2UgQ29uY2VwdFByb3RvLlRoaW5nLkVOQ09ESU5HLlJFTEFUSU9OOlxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvbkltcGwub2YodGhpbmdQcm90byk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5UaGluZy5FTkNPRElORy5BVFRSSUJVVEU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZSh0aGluZ1Byb3RvKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgXCJCYWQgZW5jb2RpbmdcIjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydCBmdW5jdGlvbiBhdHRyaWJ1dGUodGhpbmdQcm90bzogQ29uY2VwdFByb3RvLlRoaW5nKTogQXR0cmlidXRlSW1wbDxhbnk+IHtcbiAgICAgICAgc3dpdGNoICh0aGluZ1Byb3RvLmdldFZhbHVlVHlwZSgpKSB7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLlZBTFVFX1RZUEUuQk9PTEVBTjpcbiAgICAgICAgICAgICAgICByZXR1cm4gQm9vbGVhbkF0dHJpYnV0ZUltcGwub2YodGhpbmdQcm90byk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLlZBTFVFX1RZUEUuTE9ORzpcbiAgICAgICAgICAgICAgICByZXR1cm4gTG9uZ0F0dHJpYnV0ZUltcGwub2YodGhpbmdQcm90byk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLlZBTFVFX1RZUEUuRE9VQkxFOlxuICAgICAgICAgICAgICAgIHJldHVybiBEb3VibGVBdHRyaWJ1dGVJbXBsLm9mKHRoaW5nUHJvdG8pO1xuICAgICAgICAgICAgY2FzZSBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5WQUxVRV9UWVBFLlNUUklORzpcbiAgICAgICAgICAgICAgICByZXR1cm4gU3RyaW5nQXR0cmlidXRlSW1wbC5vZih0aGluZ1Byb3RvKTtcbiAgICAgICAgICAgIGNhc2UgQ29uY2VwdFByb3RvLkF0dHJpYnV0ZVR5cGUuVkFMVUVfVFlQRS5EQVRFVElNRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gRGF0ZVRpbWVBdHRyaWJ1dGVJbXBsLm9mKHRoaW5nUHJvdG8pO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBcIkJhZCB2YWx1ZSB0eXBlXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBleHBvcnQgZnVuY3Rpb24gdHlwZSh0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogVHlwZUltcGwge1xuICAgICAgICBzd2l0Y2ggKHR5cGVQcm90by5nZXRFbmNvZGluZygpKSB7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5UeXBlLkVOQ09ESU5HLlJPTEVfVFlQRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gUm9sZVR5cGVJbXBsLm9mKHR5cGVQcm90byk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGluZ1R5cGUodHlwZVByb3RvKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGV4cG9ydCBmdW5jdGlvbiB0aGluZ1R5cGUodHlwZVByb3RvOiBDb25jZXB0UHJvdG8uVHlwZSk6IFRoaW5nVHlwZUltcGwge1xuICAgICAgICBzd2l0Y2ggKHR5cGVQcm90by5nZXRFbmNvZGluZygpKSB7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5UeXBlLkVOQ09ESU5HLkVOVElUWV9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiBFbnRpdHlUeXBlSW1wbC5vZih0eXBlUHJvdG8pO1xuICAgICAgICAgICAgY2FzZSBDb25jZXB0UHJvdG8uVHlwZS5FTkNPRElORy5SRUxBVElPTl9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiBSZWxhdGlvblR5cGVJbXBsLm9mKHR5cGVQcm90byk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5UeXBlLkVOQ09ESU5HLkFUVFJJQlVURV9UWVBFOlxuICAgICAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVUeXBlKHR5cGVQcm90byk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5UeXBlLkVOQ09ESU5HLlRISU5HX1RZUEU6XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVGhpbmdUeXBlSW1wbCh0eXBlUHJvdG8uZ2V0TGFiZWwoKSwgdHlwZVByb3RvLmdldFJvb3QoKSk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IFwiQmFkIGVuY29kaW5nXCI7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBleHBvcnQgZnVuY3Rpb24gYXR0cmlidXRlVHlwZSh0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogQXR0cmlidXRlVHlwZUltcGwge1xuICAgICAgICBzd2l0Y2ggKHR5cGVQcm90by5nZXRWYWx1ZVR5cGUoKSkge1xuICAgICAgICAgICAgY2FzZSBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5WQUxVRV9UWVBFLkJPT0xFQU46XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBCb29sZWFuQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgICAgICAgICAgY2FzZSBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5WQUxVRV9UWVBFLkxPTkc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMb25nQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgICAgICAgICAgY2FzZSBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5WQUxVRV9UWVBFLkRPVUJMRTpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERvdWJsZUF0dHJpYnV0ZVR5cGVJbXBsKHR5cGVQcm90by5nZXRMYWJlbCgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICAgICAgICAgIGNhc2UgQ29uY2VwdFByb3RvLkF0dHJpYnV0ZVR5cGUuVkFMVUVfVFlQRS5TVFJJTkc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdBdHRyaWJ1dGVUeXBlSW1wbCh0eXBlUHJvdG8uZ2V0TGFiZWwoKSwgdHlwZVByb3RvLmdldFJvb3QoKSk7XG4gICAgICAgICAgICBjYXNlIENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLlZBTFVFX1RZUEUuREFURVRJTUU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsKHR5cGVQcm90by5nZXRMYWJlbCgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICAgICAgICAgIGNhc2UgQ29uY2VwdFByb3RvLkF0dHJpYnV0ZVR5cGUuVkFMVUVfVFlQRS5PQkpFQ1Q6XG4gICAgICAgICAgICAgICAgYXNzZXJ0KHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBcIkJhZCB2YWx1ZSB0eXBlXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG4iXX0=