/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("grakn-client/concept/type/impl/RoleTypeImpl", ["require", "exports", "grakn-client/dependencies_internal", "graknlabs-grpc-protocol/protobuf/concept_pb"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.RemoteRoleTypeImpl = exports.RoleTypeImpl = void 0;
    const dependencies_internal_1 = require("grakn-client/dependencies_internal");
    const concept_pb_1 = __importDefault(require("graknlabs-grpc-protocol/protobuf/concept_pb"));
    class RoleTypeImpl extends dependencies_internal_1.ThingTypeImpl {
        constructor(label, scope, isRoot) {
            super(label, isRoot);
            this._scope = scope;
        }
        static of(typeProto) {
            return new RoleTypeImpl(typeProto.getLabel(), typeProto.getScope(), typeProto.getRoot());
        }
        getScope() {
            return this._scope;
        }
        getScopedLabel() {
            return `${this._scope}:${this.getLabel()}`;
        }
        asRemote(transaction) {
            return new RemoteRoleTypeImpl(transaction, this.getLabel(), this.getScope(), this.isRoot());
        }
        toString() {
            return `${this.constructor.name}[label: ${this._scope ? `${this._scope}:${this.getLabel()}` : this.getLabel()}]`;
        }
    }
    exports.RoleTypeImpl = RoleTypeImpl;
    class RemoteRoleTypeImpl extends dependencies_internal_1.RemoteThingTypeImpl {
        constructor(transaction, label, scope, isRoot) {
            super(transaction, label, isRoot);
            this._scope = scope;
        }
        getScope() {
            return this._scope;
        }
        getScopedLabel() {
            return `${this._scope}:${this.getLabel()}`;
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        asRemote(transaction) {
            return new RemoteRoleTypeImpl(transaction, this.getLabel(), this._scope, this.isRoot());
        }
        getRelationType() {
            return __awaiter(this, void 0, void 0, function* () {
                const method = new concept_pb_1.default.Type.Req().setRoleTypeGetRelationTypeReq(new concept_pb_1.default.RoleType.GetRelationType.Req());
                const response = (yield this.execute(method)).getRoleTypeGetRelationTypeRes();
                return dependencies_internal_1.ConceptProtoReader.type(response.getRelationtype());
            });
        }
        getRelationTypes() {
            return this.typeStream(new concept_pb_1.default.Type.Req().setRoleTypeGetRelationTypesReq(new concept_pb_1.default.RoleType.GetRelationTypes.Req()), res => res.getRoleTypeGetRelationTypesRes().getRelationtypeList());
        }
        getPlayers() {
            return this.typeStream(new concept_pb_1.default.Type.Req().setRoleTypeGetPlayersReq(new concept_pb_1.default.RoleType.GetPlayers.Req()), res => res.getRoleTypeGetPlayersRes().getThingtypeList());
        }
        typeStream(method, typeGetter) {
            return super.typeStream(method.setScope(this._scope), typeGetter);
        }
        execute(method) {
            return super.execute(method.setScope(this._scope));
        }
        toString() {
            return `${this.constructor.name}[label: ${this._scope ? `${this._scope}:${this.getLabel()}` : this.getLabel()}]`;
        }
    }
    exports.RemoteRoleTypeImpl = RemoteRoleTypeImpl;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUm9sZVR5cGVJbXBsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vY29uY2VwdC90eXBlL2ltcGwvUm9sZVR5cGVJbXBsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7OztHQWlCRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQUVILDhFQVV3QztJQUN4Qyw2RkFBdUU7SUFHdkUsTUFBYSxZQUFhLFNBQVEscUNBQWE7UUFHM0MsWUFBc0IsS0FBYSxFQUFFLEtBQWEsRUFBRSxNQUFlO1lBQy9ELEtBQUssQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDckIsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDeEIsQ0FBQztRQUVELE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBNEI7WUFDbEMsT0FBTyxJQUFJLFlBQVksQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxFQUFFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQzdGLENBQUM7UUFFRCxRQUFRO1lBQ0osT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3ZCLENBQUM7UUFFRCxjQUFjO1lBQ1YsT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUM7UUFDL0MsQ0FBQztRQUVELFFBQVEsQ0FBQyxXQUF3QjtZQUM3QixPQUFPLElBQUksa0JBQWtCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7UUFDaEcsQ0FBQztRQUVELFFBQVE7WUFDSixPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLFdBQVcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQztRQUNySCxDQUFDO0tBQ0o7SUEzQkQsb0NBMkJDO0lBRUQsTUFBYSxrQkFBbUIsU0FBUSwyQ0FBbUI7UUFHdkQsWUFBWSxXQUF3QixFQUFFLEtBQWEsRUFBRSxLQUFhLEVBQUUsTUFBZTtZQUMvRSxLQUFLLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNsQyxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUN4QixDQUFDO1FBRUQsUUFBUTtZQUNKLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUN2QixDQUFDO1FBRUQsY0FBYztZQUNWLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDO1FBQy9DLENBQUM7UUFFRCxZQUFZO1lBQ1IsT0FBTyxLQUFLLENBQUMsWUFBWSxFQUEyQixDQUFDO1FBQ3pELENBQUM7UUFFRCxhQUFhO1lBQ1QsT0FBTyxLQUFLLENBQUMsYUFBYSxFQUEwQixDQUFDO1FBQ3pELENBQUM7UUFFRCxXQUFXO1lBQ1AsT0FBTyxLQUFLLENBQUMsV0FBVyxFQUEwQixDQUFDO1FBQ3ZELENBQUM7UUFFRCxRQUFRLENBQUMsV0FBd0I7WUFDN0IsT0FBTyxJQUFJLGtCQUFrQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQTtRQUMzRixDQUFDO1FBRUssZUFBZTs7Z0JBQ2pCLE1BQU0sTUFBTSxHQUFHLElBQUksb0JBQVksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsNkJBQTZCLENBQUMsSUFBSSxvQkFBWSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztnQkFDMUgsTUFBTSxRQUFRLEdBQUcsQ0FBQyxNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyw2QkFBNkIsRUFBRSxDQUFDO2dCQUM5RSxPQUFPLDBDQUFrQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFFLENBQXFCLENBQUM7WUFDbkYsQ0FBQztTQUFBO1FBRUQsZ0JBQWdCO1lBQ1osT0FBTyxJQUFJLENBQUMsVUFBVSxDQUNsQixJQUFJLG9CQUFZLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLDhCQUE4QixDQUFDLElBQUksb0JBQVksQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLENBQUMsRUFDNUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsOEJBQThCLEVBQUUsQ0FBQyxtQkFBbUIsRUFBRSxDQUE2QixDQUFDO1FBQ3ZHLENBQUM7UUFFRCxVQUFVO1lBQ04sT0FBTyxJQUFJLENBQUMsVUFBVSxDQUNsQixJQUFJLG9CQUFZLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLHdCQUF3QixDQUFDLElBQUksb0JBQVksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQ2hHLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLHdCQUF3QixFQUFFLENBQUMsZ0JBQWdCLEVBQUUsQ0FBMEIsQ0FBQztRQUMzRixDQUFDO1FBRVMsVUFBVSxDQUFDLE1BQTZCLEVBQUUsVUFBK0Q7WUFDL0csT0FBTyxLQUFLLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBQ3RFLENBQUM7UUFFUyxPQUFPLENBQUMsTUFBNkI7WUFDM0MsT0FBTyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDdkQsQ0FBQztRQUVELFFBQVE7WUFDSixPQUFPLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLFdBQVcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQztRQUNySCxDQUFDO0tBQ0o7SUE3REQsZ0RBNkRDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIExpY2Vuc2VkIHRvIHRoZSBBcGFjaGUgU29mdHdhcmUgRm91bmRhdGlvbiAoQVNGKSB1bmRlciBvbmVcbiAqIG9yIG1vcmUgY29udHJpYnV0b3IgbGljZW5zZSBhZ3JlZW1lbnRzLiAgU2VlIHRoZSBOT1RJQ0UgZmlsZVxuICogZGlzdHJpYnV0ZWQgd2l0aCB0aGlzIHdvcmsgZm9yIGFkZGl0aW9uYWwgaW5mb3JtYXRpb25cbiAqIHJlZ2FyZGluZyBjb3B5cmlnaHQgb3duZXJzaGlwLiAgVGhlIEFTRiBsaWNlbnNlcyB0aGlzIGZpbGVcbiAqIHRvIHlvdSB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGVcbiAqIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogd2l0aCB0aGUgTGljZW5zZS4gIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW5cbiAqIFwiQVMgSVNcIiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXG4gKiBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGVcbiAqIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnNcbiAqIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gICAgVGhpbmdUeXBlSW1wbCxcbiAgICBSZW1vdGVUaGluZ1R5cGVJbXBsLFxuICAgIFJvbGVUeXBlLFxuICAgIFJlbW90ZVJvbGVUeXBlLFxuICAgIEdyYWtuLFxuICAgIFJlbGF0aW9uVHlwZUltcGwsXG4gICAgU3RyZWFtLFxuICAgIENvbmNlcHRQcm90b1JlYWRlcixcbiAgICBUeXBlSW1wbCxcbn0gZnJvbSBcIi4uLy4uLy4uL2RlcGVuZGVuY2llc19pbnRlcm5hbFwiO1xuaW1wb3J0IENvbmNlcHRQcm90byBmcm9tIFwiZ3Jha25sYWJzLWdycGMtcHJvdG9jb2wvcHJvdG9idWYvY29uY2VwdF9wYlwiO1xuaW1wb3J0IFRyYW5zYWN0aW9uID0gR3Jha24uVHJhbnNhY3Rpb247XG5cbmV4cG9ydCBjbGFzcyBSb2xlVHlwZUltcGwgZXh0ZW5kcyBUaGluZ1R5cGVJbXBsIGltcGxlbWVudHMgUm9sZVR5cGUge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3Njb3BlOiBzdHJpbmc7XG5cbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgc2NvcGU6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgICAgICB0aGlzLl9zY29wZSA9IHNjb3BlO1xuICAgIH1cblxuICAgIHN0YXRpYyBvZih0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogUm9sZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSb2xlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRTY29wZSgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICB9XG5cbiAgICBnZXRTY29wZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2NvcGU7XG4gICAgfVxuXG4gICAgZ2V0U2NvcGVkTGFiZWwoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuX3Njb3BlfToke3RoaXMuZ2V0TGFiZWwoKX1gO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZVJvbGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlUm9sZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuZ2V0U2NvcGUoKSwgdGhpcy5pc1Jvb3QoKSk7XG4gICAgfVxuXG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY29uc3RydWN0b3IubmFtZX1bbGFiZWw6ICR7dGhpcy5fc2NvcGUgPyBgJHt0aGlzLl9zY29wZX06JHt0aGlzLmdldExhYmVsKCl9YCA6IHRoaXMuZ2V0TGFiZWwoKX1dYDtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVSb2xlVHlwZUltcGwgZXh0ZW5kcyBSZW1vdGVUaGluZ1R5cGVJbXBsIGltcGxlbWVudHMgUmVtb3RlUm9sZVR5cGUge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX3Njb3BlOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3Rvcih0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24sIGxhYmVsOiBzdHJpbmcsIHNjb3BlOiBzdHJpbmcsIGlzUm9vdDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcih0cmFuc2FjdGlvbiwgbGFiZWwsIGlzUm9vdCk7XG4gICAgICAgIHRoaXMuX3Njb3BlID0gc2NvcGU7XG4gICAgfVxuXG4gICAgZ2V0U2NvcGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Njb3BlO1xuICAgIH1cblxuICAgIGdldFNjb3BlZExhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLl9zY29wZX06JHt0aGlzLmdldExhYmVsKCl9YDtcbiAgICB9XG5cbiAgICBnZXRTdXBlcnR5cGUoKTogUHJvbWlzZTxSb2xlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZSgpIGFzIFByb21pc2U8Um9sZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdXBlcnR5cGVzKCk6IFN0cmVhbTxSb2xlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZXMoKSBhcyBTdHJlYW08Um9sZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdWJ0eXBlcygpOiBTdHJlYW08Um9sZVR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdWJ0eXBlcygpIGFzIFN0cmVhbTxSb2xlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZVJvbGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlUm9sZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuX3Njb3BlLCB0aGlzLmlzUm9vdCgpKVxuICAgIH1cblxuICAgIGFzeW5jIGdldFJlbGF0aW9uVHlwZSgpOiBQcm9taXNlPFJlbGF0aW9uVHlwZUltcGw+IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gbmV3IENvbmNlcHRQcm90by5UeXBlLlJlcSgpLnNldFJvbGVUeXBlR2V0UmVsYXRpb25UeXBlUmVxKG5ldyBDb25jZXB0UHJvdG8uUm9sZVR5cGUuR2V0UmVsYXRpb25UeXBlLlJlcSgpKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSAoYXdhaXQgdGhpcy5leGVjdXRlKG1ldGhvZCkpLmdldFJvbGVUeXBlR2V0UmVsYXRpb25UeXBlUmVzKCk7XG4gICAgICAgIHJldHVybiBDb25jZXB0UHJvdG9SZWFkZXIudHlwZShyZXNwb25zZS5nZXRSZWxhdGlvbnR5cGUoKSkgYXMgUmVsYXRpb25UeXBlSW1wbDtcbiAgICB9XG5cbiAgICBnZXRSZWxhdGlvblR5cGVzKCk6IFN0cmVhbTxSZWxhdGlvblR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVTdHJlYW0oXG4gICAgICAgICAgICBuZXcgQ29uY2VwdFByb3RvLlR5cGUuUmVxKCkuc2V0Um9sZVR5cGVHZXRSZWxhdGlvblR5cGVzUmVxKG5ldyBDb25jZXB0UHJvdG8uUm9sZVR5cGUuR2V0UmVsYXRpb25UeXBlcy5SZXEoKSksXG4gICAgICAgICAgICByZXMgPT4gcmVzLmdldFJvbGVUeXBlR2V0UmVsYXRpb25UeXBlc1JlcygpLmdldFJlbGF0aW9udHlwZUxpc3QoKSkgYXMgU3RyZWFtPFJlbGF0aW9uVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFBsYXllcnMoKTogU3RyZWFtPFRoaW5nVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZVN0cmVhbShcbiAgICAgICAgICAgIG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRSb2xlVHlwZUdldFBsYXllcnNSZXEobmV3IENvbmNlcHRQcm90by5Sb2xlVHlwZS5HZXRQbGF5ZXJzLlJlcSgpKSxcbiAgICAgICAgICAgIHJlcyA9PiByZXMuZ2V0Um9sZVR5cGVHZXRQbGF5ZXJzUmVzKCkuZ2V0VGhpbmd0eXBlTGlzdCgpKSBhcyBTdHJlYW08VGhpbmdUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHR5cGVTdHJlYW0obWV0aG9kOiBDb25jZXB0UHJvdG8uVHlwZS5SZXEsIHR5cGVHZXR0ZXI6IChyZXM6IENvbmNlcHRQcm90by5UeXBlLlJlcykgPT4gQ29uY2VwdFByb3RvLlR5cGVbXSk6IFN0cmVhbTxUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIudHlwZVN0cmVhbShtZXRob2Quc2V0U2NvcGUodGhpcy5fc2NvcGUpLCB0eXBlR2V0dGVyKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZXhlY3V0ZShtZXRob2Q6IENvbmNlcHRQcm90by5UeXBlLlJlcSk6IFByb21pc2U8Q29uY2VwdFByb3RvLlR5cGUuUmVzPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5leGVjdXRlKG1ldGhvZC5zZXRTY29wZSh0aGlzLl9zY29wZSkpO1xuICAgIH1cblxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9W2xhYmVsOiAke3RoaXMuX3Njb3BlID8gYCR7dGhpcy5fc2NvcGV9OiR7dGhpcy5nZXRMYWJlbCgpfWAgOiB0aGlzLmdldExhYmVsKCl9XWA7XG4gICAgfVxufVxuIl19