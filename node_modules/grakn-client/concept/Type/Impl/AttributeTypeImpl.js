/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("grakn-client/concept/type/impl/AttributeTypeImpl", ["require", "exports", "grakn-client/dependencies_internal", "graknlabs-protocol/protobuf/concept_pb"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.RemoteDateTimeAttributeTypeImpl = exports.DateTimeAttributeTypeImpl = exports.RemoteStringAttributeTypeImpl = exports.StringAttributeTypeImpl = exports.RemoteDoubleAttributeTypeImpl = exports.DoubleAttributeTypeImpl = exports.RemoteLongAttributeTypeImpl = exports.LongAttributeTypeImpl = exports.RemoteBooleanAttributeTypeImpl = exports.BooleanAttributeTypeImpl = exports.RemoteAttributeTypeImpl = exports.AttributeTypeImpl = void 0;
    const dependencies_internal_1 = require("grakn-client/dependencies_internal");
    const concept_pb_1 = __importDefault(require("graknlabs-protocol/protobuf/concept_pb"));
    var ValueType = dependencies_internal_1.AttributeType.ValueType;
    var isKeyable = dependencies_internal_1.AttributeType.ValueType.isKeyable;
    class AttributeTypeImpl extends dependencies_internal_1.ThingTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        getValueType() {
            return ValueType.OBJECT;
        }
        isKeyable() {
            return isKeyable(this.getValueType());
        }
        asRemote(transaction) {
            return new RemoteAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.AttributeTypeImpl = AttributeTypeImpl;
    AttributeTypeImpl.ROOT_LABEL = "attribute";
    class RemoteAttributeTypeImpl extends dependencies_internal_1.RemoteThingTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.OBJECT;
        }
        isKeyable() {
            return isKeyable(this.getValueType());
        }
        setSupertype(attributeType) {
            return super.setSupertype(attributeType);
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        getOwners(onlyKey) {
            const method = new concept_pb_1.default.Type.Req()
                .setAttributeTypeGetOwnersReq(new concept_pb_1.default.AttributeType.GetOwners.Req().setOnlyKey(onlyKey || false));
            return this.typeStream(method, res => res.getAttributeTypeGetOwnersRes().getOwnerList());
        }
        putInternal(valueProto) {
            return __awaiter(this, void 0, void 0, function* () {
                const method = new concept_pb_1.default.Type.Req().setAttributeTypePutReq(new concept_pb_1.default.AttributeType.Put.Req().setValue(valueProto));
                return dependencies_internal_1.ConceptProtoReader.attribute(yield this.execute(method).then(res => res.getAttributeTypePutRes().getAttribute()));
            });
        }
        getInternal(valueProto) {
            return __awaiter(this, void 0, void 0, function* () {
                const method = new concept_pb_1.default.Type.Req().setAttributeTypeGetReq(new concept_pb_1.default.AttributeType.Get.Req().setValue(valueProto));
                const response = yield this.execute(method).then(res => res.getAttributeTypeGetRes());
                return response.getResCase() === concept_pb_1.default.AttributeType.Get.Res.ResCase.ATTRIBUTE ? dependencies_internal_1.ConceptProtoReader.attribute(response.getAttribute()) : null;
            });
        }
        asRemote(transaction) {
            return new RemoteAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.RemoteAttributeTypeImpl = RemoteAttributeTypeImpl;
    class BooleanAttributeTypeImpl extends AttributeTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new BooleanAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        getValueType() {
            return ValueType.BOOLEAN;
        }
        asRemote(transaction) {
            return new RemoteBooleanAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.BooleanAttributeTypeImpl = BooleanAttributeTypeImpl;
    class RemoteBooleanAttributeTypeImpl extends RemoteAttributeTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.BOOLEAN;
        }
        asRemote(transaction) {
            return new RemoteBooleanAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        setSupertype(type) {
            return super.setSupertype(type);
        }
        put(value) {
            return this.putInternal(dependencies_internal_1.ConceptProtoBuilder.booleanAttributeValue(value));
        }
        get(value) {
            return this.getInternal(dependencies_internal_1.ConceptProtoBuilder.booleanAttributeValue(value));
        }
    }
    exports.RemoteBooleanAttributeTypeImpl = RemoteBooleanAttributeTypeImpl;
    class LongAttributeTypeImpl extends AttributeTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new LongAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        getValueType() {
            return ValueType.LONG;
        }
        asRemote(transaction) {
            return new RemoteLongAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.LongAttributeTypeImpl = LongAttributeTypeImpl;
    class RemoteLongAttributeTypeImpl extends RemoteAttributeTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.LONG;
        }
        asRemote(transaction) {
            return new RemoteLongAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        setSupertype(type) {
            return super.setSupertype(type);
        }
        put(value) {
            return this.putInternal(dependencies_internal_1.ConceptProtoBuilder.longAttributeValue(value));
        }
        get(value) {
            return this.getInternal(dependencies_internal_1.ConceptProtoBuilder.longAttributeValue(value));
        }
    }
    exports.RemoteLongAttributeTypeImpl = RemoteLongAttributeTypeImpl;
    class DoubleAttributeTypeImpl extends AttributeTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new DoubleAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        getValueType() {
            return ValueType.DOUBLE;
        }
        asRemote(transaction) {
            return new RemoteDoubleAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.DoubleAttributeTypeImpl = DoubleAttributeTypeImpl;
    class RemoteDoubleAttributeTypeImpl extends RemoteAttributeTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.DOUBLE;
        }
        asRemote(transaction) {
            return new RemoteDoubleAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        setSupertype(type) {
            return super.setSupertype(type);
        }
        put(value) {
            return this.putInternal(dependencies_internal_1.ConceptProtoBuilder.doubleAttributeValue(value));
        }
        get(value) {
            return this.getInternal(dependencies_internal_1.ConceptProtoBuilder.doubleAttributeValue(value));
        }
    }
    exports.RemoteDoubleAttributeTypeImpl = RemoteDoubleAttributeTypeImpl;
    class StringAttributeTypeImpl extends AttributeTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new StringAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        getValueType() {
            return ValueType.STRING;
        }
        asRemote(transaction) {
            return new RemoteStringAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.StringAttributeTypeImpl = StringAttributeTypeImpl;
    class RemoteStringAttributeTypeImpl extends RemoteAttributeTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.STRING;
        }
        asRemote(transaction) {
            return new RemoteStringAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        setSupertype(type) {
            return super.setSupertype(type);
        }
        put(value) {
            return this.putInternal(dependencies_internal_1.ConceptProtoBuilder.stringAttributeValue(value));
        }
        get(value) {
            return this.getInternal(dependencies_internal_1.ConceptProtoBuilder.stringAttributeValue(value));
        }
    }
    exports.RemoteStringAttributeTypeImpl = RemoteStringAttributeTypeImpl;
    class DateTimeAttributeTypeImpl extends AttributeTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new DateTimeAttributeTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        getValueType() {
            return ValueType.DATETIME;
        }
        asRemote(transaction) {
            return new RemoteDateTimeAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.DateTimeAttributeTypeImpl = DateTimeAttributeTypeImpl;
    class RemoteDateTimeAttributeTypeImpl extends RemoteAttributeTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        getValueType() {
            return ValueType.DATETIME;
        }
        asRemote(transaction) {
            return new RemoteDateTimeAttributeTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
        setSupertype(type) {
            return super.setSupertype(type);
        }
        put(value) {
            return this.putInternal(dependencies_internal_1.ConceptProtoBuilder.dateTimeAttributeValue(value));
        }
        get(value) {
            return this.getInternal(dependencies_internal_1.ConceptProtoBuilder.dateTimeAttributeValue(value));
        }
    }
    exports.RemoteDateTimeAttributeTypeImpl = RemoteDateTimeAttributeTypeImpl;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXR0cmlidXRlVHlwZUltcGwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9jb25jZXB0L3R5cGUvaW1wbC9BdHRyaWJ1dGVUeXBlSW1wbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FpQkc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFFSCw4RUF5QndDO0lBQ3hDLHdGQUFrRTtJQUVsRSxJQUFPLFNBQVMsR0FBRyxxQ0FBYSxDQUFDLFNBQVMsQ0FBQztJQUUzQyxJQUFPLFNBQVMsR0FBRyxxQ0FBYSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7SUFFckQsTUFBYSxpQkFBa0IsU0FBUSxxQ0FBYTtRQUloRCxZQUFZLEtBQWEsRUFBRSxNQUFlO1lBQ3RDLEtBQUssQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDekIsQ0FBQztRQUVELFlBQVk7WUFDUixPQUFPLFNBQVMsQ0FBQyxNQUFNLENBQUM7UUFDNUIsQ0FBQztRQUVELFNBQVM7WUFDTCxPQUFPLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztRQUMxQyxDQUFDO1FBRUQsUUFBUSxDQUFDLFdBQXdCO1lBQzdCLE9BQU8sSUFBSSx1QkFBdUIsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1FBQ25GLENBQUM7O0lBbEJMLDhDQW1CQztJQWpCa0IsNEJBQVUsR0FBRyxXQUFXLENBQUM7SUFtQjVDLE1BQWEsdUJBQXdCLFNBQVEsMkNBQW1CO1FBRTVELFlBQVksV0FBd0IsRUFBRSxLQUFhLEVBQUUsTUFBZTtZQUNoRSxLQUFLLENBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN0QyxDQUFDO1FBRUQsWUFBWTtZQUNSLE9BQU8sU0FBUyxDQUFDLE1BQU0sQ0FBQztRQUM1QixDQUFD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RSxZQUFZLFdBQXdCLEVBQUUsS0FBYSxFQUFFLE1BQWU7WUFDaEUsS0FBSyxDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUVELFlBQVk7WUFDUixPQUFPLFNBQVMsQ0FBQyxRQUFRLENBQUM7UUFDOUIsQ0FBQztRQUVELFFBQVEsQ0FBQyxXQUF3QjtZQUM3QixPQUFPLElBQUksK0JBQStCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUM1RixDQUFDO1FBRUQsWUFBWTtZQUNSLE9BQU8sS0FBSyxDQUFDLFlBQVksRUFBd0MsQ0FBQztRQUN0RSxDQUFDO1FBRUQsYUFBYTtZQUNULE9BQU8sS0FBSyxDQUFDLGFBQWEsRUFBdUMsQ0FBQztRQUN0RSxDQUFDO1FBRUQsV0FBVztZQUNQLE9BQU8sS0FBSyxDQUFDLFdBQVcsRUFBdUMsQ0FBQztRQUNwRSxDQUFDO1FBRUQsWUFBWTtZQUNSLE9BQU8sS0FBSyxDQUFDLFlBQVksRUFBbUMsQ0FBQztRQUNqRSxDQUFDO1FBRUQsWUFBWSxDQUFDLElBQTJCO1lBQ3BDLE9BQU8sS0FBSyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNwQyxDQUFDO1FBRUQsR0FBRyxDQUFDLEtBQVc7WUFDWCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsMkNBQW1CLENBQUMsc0JBQXNCLENBQUMsS0FBSyxDQUFDLENBQW1DLENBQUM7UUFDakgsQ0FBQztRQUVELEdBQUcsQ0FBQyxLQUFXO1lBQ1gsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLDJDQUFtQixDQUFDLHNCQUFzQixDQUFDLEtBQUssQ0FBQyxDQUFtQyxDQUFDO1FBQ2pILENBQUM7S0FDSjtJQXpDRCwwRUF5Q0MiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIChBU0YpIHVuZGVyIG9uZVxuICogb3IgbW9yZSBjb250cmlidXRvciBsaWNlbnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlXG4gKiBkaXN0cmlidXRlZCB3aXRoIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxuICogcmVnYXJkaW5nIGNvcHlyaWdodCBvd25lcnNoaXAuICBUaGUgQVNGIGxpY2Vuc2VzIHRoaXMgZmlsZVxuICogdG8geW91IHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZVxuICogXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlXG4gKiB3aXRoIHRoZSBMaWNlbnNlLiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhblxuICogXCJBUyBJU1wiIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcbiAqIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZVxuICogc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZCBsaW1pdGF0aW9uc1xuICogdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgICBSZW1vdGVUaGluZ1R5cGVJbXBsLFxuICAgIFRoaW5nVHlwZUltcGwsXG4gICAgQXR0cmlidXRlVHlwZSxcbiAgICBCb29sZWFuQXR0cmlidXRlVHlwZSxcbiAgICBEYXRlVGltZUF0dHJpYnV0ZVR5cGUsXG4gICAgRG91YmxlQXR0cmlidXRlVHlwZSxcbiAgICBMb25nQXR0cmlidXRlVHlwZSxcbiAgICBSZW1vdGVBdHRyaWJ1dGVUeXBlLFxuICAgIFJlbW90ZUJvb2xlYW5BdHRyaWJ1dGVUeXBlLFxuICAgIFJlbW90ZURhdGVUaW1lQXR0cmlidXRlVHlwZSxcbiAgICBSZW1vdGVEb3VibGVBdHRyaWJ1dGVUeXBlLFxuICAgIFJlbW90ZUxvbmdBdHRyaWJ1dGVUeXBlLFxuICAgIFJlbW90ZVN0cmluZ0F0dHJpYnV0ZVR5cGUsXG4gICAgU3RyaW5nQXR0cmlidXRlVHlwZSxcbiAgICBHcmFrbixcbiAgICBBdHRyaWJ1dGVJbXBsLFxuICAgIEJvb2xlYW5BdHRyaWJ1dGVJbXBsLFxuICAgIERhdGVUaW1lQXR0cmlidXRlSW1wbCxcbiAgICBEb3VibGVBdHRyaWJ1dGVJbXBsLFxuICAgIExvbmdBdHRyaWJ1dGVJbXBsLFxuICAgIFN0cmluZ0F0dHJpYnV0ZUltcGwsXG4gICAgU3RyZWFtLFxuICAgIENvbmNlcHRQcm90b0J1aWxkZXIsXG4gICAgQ29uY2VwdFByb3RvUmVhZGVyLFxufSBmcm9tIFwiLi4vLi4vLi4vZGVwZW5kZW5jaWVzX2ludGVybmFsXCI7XG5pbXBvcnQgQ29uY2VwdFByb3RvIGZyb20gXCJncmFrbmxhYnMtcHJvdG9jb2wvcHJvdG9idWYvY29uY2VwdF9wYlwiO1xuaW1wb3J0IFRyYW5zYWN0aW9uID0gR3Jha24uVHJhbnNhY3Rpb247XG5pbXBvcnQgVmFsdWVUeXBlID0gQXR0cmlidXRlVHlwZS5WYWx1ZVR5cGU7XG5pbXBvcnQgVmFsdWVDbGFzcyA9IEF0dHJpYnV0ZVR5cGUuVmFsdWVDbGFzcztcbmltcG9ydCBpc0tleWFibGUgPSBBdHRyaWJ1dGVUeXBlLlZhbHVlVHlwZS5pc0tleWFibGU7XG5cbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIFRoaW5nVHlwZUltcGwgaW1wbGVtZW50cyBBdHRyaWJ1dGVUeXBlIHtcblxuICAgIHByaXZhdGUgc3RhdGljIFJPT1RfTEFCRUwgPSBcImF0dHJpYnV0ZVwiO1xuXG4gICAgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIGdldFZhbHVlVHlwZSgpOiBWYWx1ZVR5cGUge1xuICAgICAgICByZXR1cm4gVmFsdWVUeXBlLk9CSkVDVDtcbiAgICB9XG5cbiAgICBpc0tleWFibGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBpc0tleWFibGUodGhpcy5nZXRWYWx1ZVR5cGUoKSk7XG4gICAgfVxuXG4gICAgYXNSZW1vdGUodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKTogUmVtb3RlQXR0cmlidXRlVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZUF0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVtb3RlQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBSZW1vdGVUaGluZ1R5cGVJbXBsIGltcGxlbWVudHMgUmVtb3RlQXR0cmlidXRlVHlwZSB7XG5cbiAgICBjb25zdHJ1Y3Rvcih0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24sIGxhYmVsOiBzdHJpbmcsIGlzUm9vdDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcih0cmFuc2FjdGlvbiwgbGFiZWwsIGlzUm9vdCk7XG4gICAgfVxuXG4gICAgZ2V0VmFsdWVUeXBlKCk6IFZhbHVlVHlwZSB7XG4gICAgICAgIHJldHVybiBWYWx1ZVR5cGUuT0JKRUNUO1xuICAgIH1cblxuICAgIGlzS2V5YWJsZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGlzS2V5YWJsZSh0aGlzLmdldFZhbHVlVHlwZSgpKTtcbiAgICB9XG5cbiAgICBzZXRTdXBlcnR5cGUoYXR0cmlidXRlVHlwZTogQXR0cmlidXRlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuc2V0U3VwZXJ0eXBlKGF0dHJpYnV0ZVR5cGUpO1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZSgpOiBQcm9taXNlPEF0dHJpYnV0ZVR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdXBlcnR5cGUoKSBhcyBQcm9taXNlPEF0dHJpYnV0ZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdXBlcnR5cGVzKCk6IFN0cmVhbTxBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlcygpIGFzIFN0cmVhbTxBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0U3VidHlwZXMoKTogU3RyZWFtPEF0dHJpYnV0ZVR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdWJ0eXBlcygpIGFzIFN0cmVhbTxBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0SW5zdGFuY2VzKCk6IFN0cmVhbTxBdHRyaWJ1dGVJbXBsPFZhbHVlQ2xhc3M+PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRJbnN0YW5jZXMoKSBhcyBTdHJlYW08QXR0cmlidXRlSW1wbDxWYWx1ZUNsYXNzPj47XG4gICAgfVxuXG4gICAgZ2V0T3duZXJzKCk6IFN0cmVhbTxUaGluZ1R5cGVJbXBsPjtcbiAgICBnZXRPd25lcnMob25seUtleT86IGJvb2xlYW4pOiBTdHJlYW08VGhpbmdUeXBlSW1wbD4ge1xuICAgICAgICBjb25zdCBtZXRob2QgPSBuZXcgQ29uY2VwdFByb3RvLlR5cGUuUmVxKClcbiAgICAgICAgICAgIC5zZXRBdHRyaWJ1dGVUeXBlR2V0T3duZXJzUmVxKG5ldyBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5HZXRPd25lcnMuUmVxKCkuc2V0T25seUtleShvbmx5S2V5IHx8IGZhbHNlKSk7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGVTdHJlYW0obWV0aG9kLCByZXMgPT4gcmVzLmdldEF0dHJpYnV0ZVR5cGVHZXRPd25lcnNSZXMoKS5nZXRPd25lckxpc3QoKSkgYXMgU3RyZWFtPFRoaW5nVHlwZUltcGw+O1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhc3luYyBwdXRJbnRlcm5hbCh2YWx1ZVByb3RvOiBDb25jZXB0UHJvdG8uQXR0cmlidXRlLlZhbHVlKTogUHJvbWlzZTxBdHRyaWJ1dGVJbXBsPFZhbHVlQ2xhc3M+PiB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRBdHRyaWJ1dGVUeXBlUHV0UmVxKG5ldyBDb25jZXB0UHJvdG8uQXR0cmlidXRlVHlwZS5QdXQuUmVxKCkuc2V0VmFsdWUodmFsdWVQcm90bykpO1xuICAgICAgICByZXR1cm4gQ29uY2VwdFByb3RvUmVhZGVyLmF0dHJpYnV0ZShhd2FpdCB0aGlzLmV4ZWN1dGUobWV0aG9kKS50aGVuKHJlcyA9PiByZXMuZ2V0QXR0cmlidXRlVHlwZVB1dFJlcygpLmdldEF0dHJpYnV0ZSgpKSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGFzeW5jIGdldEludGVybmFsKHZhbHVlUHJvdG86IENvbmNlcHRQcm90by5BdHRyaWJ1dGUuVmFsdWUpOiBQcm9taXNlPEF0dHJpYnV0ZUltcGw8VmFsdWVDbGFzcz4+IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gbmV3IENvbmNlcHRQcm90by5UeXBlLlJlcSgpLnNldEF0dHJpYnV0ZVR5cGVHZXRSZXEobmV3IENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLkdldC5SZXEoKS5zZXRWYWx1ZSh2YWx1ZVByb3RvKSk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5leGVjdXRlKG1ldGhvZCkudGhlbihyZXMgPT4gcmVzLmdldEF0dHJpYnV0ZVR5cGVHZXRSZXMoKSk7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5nZXRSZXNDYXNlKCkgPT09IENvbmNlcHRQcm90by5BdHRyaWJ1dGVUeXBlLkdldC5SZXMuUmVzQ2FzZS5BVFRSSUJVVEUgPyBDb25jZXB0UHJvdG9SZWFkZXIuYXR0cmlidXRlKHJlc3BvbnNlLmdldEF0dHJpYnV0ZSgpKSA6IG51bGw7XG4gICAgfVxuXG4gICAgYXNSZW1vdGUodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKTogUmVtb3RlQXR0cmlidXRlVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZUF0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJvb2xlYW5BdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIEF0dHJpYnV0ZVR5cGVJbXBsIGltcGxlbWVudHMgQm9vbGVhbkF0dHJpYnV0ZVR5cGUge1xuXG4gICAgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIHN0YXRpYyBvZih0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogQm9vbGVhbkF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCb29sZWFuQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgIH1cblxuICAgIGdldFZhbHVlVHlwZSgpOiBWYWx1ZVR5cGUge1xuICAgICAgICByZXR1cm4gVmFsdWVUeXBlLkJPT0xFQU47XG4gICAgfVxuXG4gICAgYXNSZW1vdGUodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKTogUmVtb3RlQm9vbGVhbkF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVCb29sZWFuQXR0cmlidXRlVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVCb29sZWFuQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBSZW1vdGVBdHRyaWJ1dGVUeXBlSW1wbCBpbXBsZW1lbnRzIFJlbW90ZUJvb2xlYW5BdHRyaWJ1dGVUeXBlIHtcblxuICAgIGNvbnN0cnVjdG9yKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbiwgbGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHRyYW5zYWN0aW9uLCBsYWJlbCwgaXNSb290KTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZVR5cGUoKTogVmFsdWVUeXBlIHtcbiAgICAgICAgcmV0dXJuIFZhbHVlVHlwZS5CT09MRUFOO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZUJvb2xlYW5BdHRyaWJ1dGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlQm9vbGVhbkF0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpO1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZSgpOiBQcm9taXNlPEJvb2xlYW5BdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlKCkgYXMgUHJvbWlzZTxCb29sZWFuQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZXMoKTogU3RyZWFtPEJvb2xlYW5BdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlcygpIGFzIFN0cmVhbTxCb29sZWFuQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1YnR5cGVzKCk6IFN0cmVhbTxCb29sZWFuQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1YnR5cGVzKCkgYXMgU3RyZWFtPEJvb2xlYW5BdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0SW5zdGFuY2VzKCk6IFN0cmVhbTxCb29sZWFuQXR0cmlidXRlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0SW5zdGFuY2VzKCkgYXMgU3RyZWFtPEJvb2xlYW5BdHRyaWJ1dGVJbXBsPjtcbiAgICB9XG5cbiAgICBzZXRTdXBlcnR5cGUodHlwZTogQm9vbGVhbkF0dHJpYnV0ZVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnNldFN1cGVydHlwZSh0eXBlKTtcbiAgICB9XG5cbiAgICBwdXQodmFsdWU6IGJvb2xlYW4pOiBQcm9taXNlPEJvb2xlYW5BdHRyaWJ1dGVJbXBsPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dEludGVybmFsKENvbmNlcHRQcm90b0J1aWxkZXIuYm9vbGVhbkF0dHJpYnV0ZVZhbHVlKHZhbHVlKSkgYXMgUHJvbWlzZTxCb29sZWFuQXR0cmlidXRlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0KHZhbHVlOiBib29sZWFuKTogUHJvbWlzZTxCb29sZWFuQXR0cmlidXRlSW1wbD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcm5hbChDb25jZXB0UHJvdG9CdWlsZGVyLmJvb2xlYW5BdHRyaWJ1dGVWYWx1ZSh2YWx1ZSkpIGFzIFByb21pc2U8Qm9vbGVhbkF0dHJpYnV0ZUltcGw+O1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIExvbmdBdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIEF0dHJpYnV0ZVR5cGVJbXBsIGltcGxlbWVudHMgTG9uZ0F0dHJpYnV0ZVR5cGUge1xuXG4gICAgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIHN0YXRpYyBvZih0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogTG9uZ0F0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBMb25nQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgIH1cblxuICAgIGdldFZhbHVlVHlwZSgpOiBWYWx1ZVR5cGUge1xuICAgICAgICByZXR1cm4gVmFsdWVUeXBlLkxPTkc7XG4gICAgfVxuXG4gICAgYXNSZW1vdGUodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKTogUmVtb3RlTG9uZ0F0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVMb25nQXR0cmlidXRlVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVMb25nQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBSZW1vdGVBdHRyaWJ1dGVUeXBlSW1wbCBpbXBsZW1lbnRzIFJlbW90ZUxvbmdBdHRyaWJ1dGVUeXBlIHtcblxuICAgIGNvbnN0cnVjdG9yKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbiwgbGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHRyYW5zYWN0aW9uLCBsYWJlbCwgaXNSb290KTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZVR5cGUoKTogVmFsdWVUeXBlIHtcbiAgICAgICAgcmV0dXJuIFZhbHVlVHlwZS5MT05HO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZUxvbmdBdHRyaWJ1dGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlTG9uZ0F0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpO1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZSgpOiBQcm9taXNlPExvbmdBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlKCkgYXMgUHJvbWlzZTxMb25nQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZXMoKTogU3RyZWFtPExvbmdBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlcygpIGFzIFN0cmVhbTxMb25nQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1YnR5cGVzKCk6IFN0cmVhbTxMb25nQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1YnR5cGVzKCkgYXMgU3RyZWFtPExvbmdBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0SW5zdGFuY2VzKCk6IFN0cmVhbTxMb25nQXR0cmlidXRlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0SW5zdGFuY2VzKCkgYXMgU3RyZWFtPExvbmdBdHRyaWJ1dGVJbXBsPjtcbiAgICB9XG5cbiAgICBzZXRTdXBlcnR5cGUodHlwZTogTG9uZ0F0dHJpYnV0ZVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnNldFN1cGVydHlwZSh0eXBlKTtcbiAgICB9XG5cbiAgICBwdXQodmFsdWU6IG51bWJlcik6IFByb21pc2U8TG9uZ0F0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHV0SW50ZXJuYWwoQ29uY2VwdFByb3RvQnVpbGRlci5sb25nQXR0cmlidXRlVmFsdWUodmFsdWUpKSBhcyBQcm9taXNlPExvbmdBdHRyaWJ1dGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXQodmFsdWU6IG51bWJlcik6IFByb21pc2U8TG9uZ0F0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW50ZXJuYWwoQ29uY2VwdFByb3RvQnVpbGRlci5sb25nQXR0cmlidXRlVmFsdWUodmFsdWUpKSBhcyBQcm9taXNlPExvbmdBdHRyaWJ1dGVJbXBsPjtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIEF0dHJpYnV0ZVR5cGVJbXBsIGltcGxlbWVudHMgRG91YmxlQXR0cmlidXRlVHlwZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihsYWJlbDogc3RyaW5nLCBpc1Jvb3Q6IGJvb2xlYW4pIHtcbiAgICAgICAgc3VwZXIobGFiZWwsIGlzUm9vdCk7XG4gICAgfVxuXG4gICAgc3RhdGljIG9mKHR5cGVQcm90bzogQ29uY2VwdFByb3RvLlR5cGUpOiBEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgRG91YmxlQXR0cmlidXRlVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgIH1cblxuICAgIGdldFZhbHVlVHlwZSgpOiBWYWx1ZVR5cGUge1xuICAgICAgICByZXR1cm4gVmFsdWVUeXBlLkRPVUJMRTtcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlRG91YmxlQXR0cmlidXRlVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIFJlbW90ZUF0dHJpYnV0ZVR5cGVJbXBsIGltcGxlbWVudHMgUmVtb3RlRG91YmxlQXR0cmlidXRlVHlwZSB7XG5cbiAgICBjb25zdHJ1Y3Rvcih0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24sIGxhYmVsOiBzdHJpbmcsIGlzUm9vdDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcih0cmFuc2FjdGlvbiwgbGFiZWwsIGlzUm9vdCk7XG4gICAgfVxuXG4gICAgZ2V0VmFsdWVUeXBlKCk6IFZhbHVlVHlwZSB7XG4gICAgICAgIHJldHVybiBWYWx1ZVR5cGUuRE9VQkxFO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZURvdWJsZUF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbCh0cmFuc2FjdGlvbiwgdGhpcy5nZXRMYWJlbCgpLCB0aGlzLmlzUm9vdCgpKTtcbiAgICB9XG5cbiAgICBnZXRTdXBlcnR5cGUoKTogUHJvbWlzZTxEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlKCkgYXMgUHJvbWlzZTxEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0U3VwZXJ0eXBlcygpOiBTdHJlYW08RG91YmxlQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZXMoKSBhcyBTdHJlYW08RG91YmxlQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1YnR5cGVzKCk6IFN0cmVhbTxEb3VibGVBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VidHlwZXMoKSBhcyBTdHJlYW08RG91YmxlQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldEluc3RhbmNlcygpOiBTdHJlYW08RG91YmxlQXR0cmlidXRlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0SW5zdGFuY2VzKCkgYXMgU3RyZWFtPERvdWJsZUF0dHJpYnV0ZUltcGw+O1xuICAgIH1cblxuICAgIHNldFN1cGVydHlwZSh0eXBlOiBEb3VibGVBdHRyaWJ1dGVUeXBlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5zZXRTdXBlcnR5cGUodHlwZSk7XG4gICAgfVxuXG4gICAgcHV0KHZhbHVlOiBudW1iZXIpOiBQcm9taXNlPERvdWJsZUF0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHV0SW50ZXJuYWwoQ29uY2VwdFByb3RvQnVpbGRlci5kb3VibGVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSkpIGFzIFByb21pc2U8RG91YmxlQXR0cmlidXRlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0KHZhbHVlOiBudW1iZXIpOiBQcm9taXNlPERvdWJsZUF0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW50ZXJuYWwoQ29uY2VwdFByb3RvQnVpbGRlci5kb3VibGVBdHRyaWJ1dGVWYWx1ZSh2YWx1ZSkpIGFzIFByb21pc2U8RG91YmxlQXR0cmlidXRlSW1wbD47XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3RyaW5nQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBBdHRyaWJ1dGVUeXBlSW1wbCBpbXBsZW1lbnRzIFN0cmluZ0F0dHJpYnV0ZVR5cGUge1xuXG4gICAgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIHN0YXRpYyBvZih0eXBlUHJvdG86IENvbmNlcHRQcm90by5UeXBlKTogU3RyaW5nQXR0cmlidXRlVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0F0dHJpYnV0ZVR5cGVJbXBsKHR5cGVQcm90by5nZXRMYWJlbCgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZVR5cGUoKTogVmFsdWVUeXBlIHtcbiAgICAgICAgcmV0dXJuIFZhbHVlVHlwZS5TVFJJTkc7XG4gICAgfVxuXG4gICAgYXNSZW1vdGUodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uKTogUmVtb3RlU3RyaW5nQXR0cmlidXRlVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZVN0cmluZ0F0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVtb3RlU3RyaW5nQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBSZW1vdGVBdHRyaWJ1dGVUeXBlSW1wbCBpbXBsZW1lbnRzIFJlbW90ZVN0cmluZ0F0dHJpYnV0ZVR5cGUge1xuXG4gICAgY29uc3RydWN0b3IodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uLCBsYWJlbDogc3RyaW5nLCBpc1Jvb3Q6IGJvb2xlYW4pIHtcbiAgICAgICAgc3VwZXIodHJhbnNhY3Rpb24sIGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIGdldFZhbHVlVHlwZSgpOiBWYWx1ZVR5cGUge1xuICAgICAgICByZXR1cm4gVmFsdWVUeXBlLlNUUklORztcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVTdHJpbmdBdHRyaWJ1dGVUeXBlSW1wbCB7XG4gICAgICAgIHJldHVybiBuZXcgUmVtb3RlU3RyaW5nQXR0cmlidXRlVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSk7XG4gICAgfVxuXG4gICAgZ2V0U3VwZXJ0eXBlKCk6IFByb21pc2U8U3RyaW5nQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZSgpIGFzIFByb21pc2U8U3RyaW5nQXR0cmlidXRlVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZXMoKTogU3RyZWFtPFN0cmluZ0F0dHJpYnV0ZVR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdXBlcnR5cGVzKCkgYXMgU3RyZWFtPFN0cmluZ0F0dHJpYnV0ZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdWJ0eXBlcygpOiBTdHJlYW08U3RyaW5nQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1YnR5cGVzKCkgYXMgU3RyZWFtPFN0cmluZ0F0dHJpYnV0ZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRJbnN0YW5jZXMoKTogU3RyZWFtPFN0cmluZ0F0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEluc3RhbmNlcygpIGFzIFN0cmVhbTxTdHJpbmdBdHRyaWJ1dGVJbXBsPjtcbiAgICB9XG5cbiAgICBzZXRTdXBlcnR5cGUodHlwZTogU3RyaW5nQXR0cmlidXRlVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuc2V0U3VwZXJ0eXBlKHR5cGUpO1xuICAgIH1cblxuICAgIHB1dCh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxTdHJpbmdBdHRyaWJ1dGVJbXBsPiB7XG4gICAgICAgIHJldHVybiB0aGlzLnB1dEludGVybmFsKENvbmNlcHRQcm90b0J1aWxkZXIuc3RyaW5nQXR0cmlidXRlVmFsdWUodmFsdWUpKSBhcyBQcm9taXNlPFN0cmluZ0F0dHJpYnV0ZUltcGw+O1xuICAgIH1cblxuICAgIGdldCh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxTdHJpbmdBdHRyaWJ1dGVJbXBsPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEludGVybmFsKENvbmNlcHRQcm90b0J1aWxkZXIuc3RyaW5nQXR0cmlidXRlVmFsdWUodmFsdWUpKSBhcyBQcm9taXNlPFN0cmluZ0F0dHJpYnV0ZUltcGw+O1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIERhdGVUaW1lQXR0cmlidXRlVHlwZUltcGwgZXh0ZW5kcyBBdHRyaWJ1dGVUeXBlSW1wbCBpbXBsZW1lbnRzIERhdGVUaW1lQXR0cmlidXRlVHlwZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihsYWJlbDogc3RyaW5nLCBpc1Jvb3Q6IGJvb2xlYW4pIHtcbiAgICAgICAgc3VwZXIobGFiZWwsIGlzUm9vdCk7XG4gICAgfVxuXG4gICAgc3RhdGljIG9mKHR5cGVQcm90bzogQ29uY2VwdFByb3RvLlR5cGUpOiBEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsKHR5cGVQcm90by5nZXRMYWJlbCgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZVR5cGUoKTogVmFsdWVUeXBlIHtcbiAgICAgICAgcmV0dXJuIFZhbHVlVHlwZS5EQVRFVElNRTtcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVtb3RlRGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbCBleHRlbmRzIFJlbW90ZUF0dHJpYnV0ZVR5cGVJbXBsIGltcGxlbWVudHMgUmVtb3RlRGF0ZVRpbWVBdHRyaWJ1dGVUeXBlIHtcblxuICAgIGNvbnN0cnVjdG9yKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbiwgbGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHRyYW5zYWN0aW9uLCBsYWJlbCwgaXNSb290KTtcbiAgICB9XG5cbiAgICBnZXRWYWx1ZVR5cGUoKTogVmFsdWVUeXBlIHtcbiAgICAgICAgcmV0dXJuIFZhbHVlVHlwZS5EQVRFVElNRTtcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpO1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZSgpOiBQcm9taXNlPERhdGVUaW1lQXR0cmlidXRlVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZSgpIGFzIFByb21pc2U8RGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0U3VwZXJ0eXBlcygpOiBTdHJlYW08RGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlcygpIGFzIFN0cmVhbTxEYXRlVGltZUF0dHJpYnV0ZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdWJ0eXBlcygpOiBTdHJlYW08RGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VidHlwZXMoKSBhcyBTdHJlYW08RGF0ZVRpbWVBdHRyaWJ1dGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0SW5zdGFuY2VzKCk6IFN0cmVhbTxEYXRlVGltZUF0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEluc3RhbmNlcygpIGFzIFN0cmVhbTxEYXRlVGltZUF0dHJpYnV0ZUltcGw+O1xuICAgIH1cblxuICAgIHNldFN1cGVydHlwZSh0eXBlOiBEYXRlVGltZUF0dHJpYnV0ZVR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnNldFN1cGVydHlwZSh0eXBlKTtcbiAgICB9XG5cbiAgICBwdXQodmFsdWU6IERhdGUpOiBQcm9taXNlPERhdGVUaW1lQXR0cmlidXRlSW1wbD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5wdXRJbnRlcm5hbChDb25jZXB0UHJvdG9CdWlsZGVyLmRhdGVUaW1lQXR0cmlidXRlVmFsdWUodmFsdWUpKSBhcyBQcm9taXNlPERhdGVUaW1lQXR0cmlidXRlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0KHZhbHVlOiBEYXRlKTogUHJvbWlzZTxEYXRlVGltZUF0dHJpYnV0ZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW50ZXJuYWwoQ29uY2VwdFByb3RvQnVpbGRlci5kYXRlVGltZUF0dHJpYnV0ZVZhbHVlKHZhbHVlKSkgYXMgUHJvbWlzZTxEYXRlVGltZUF0dHJpYnV0ZUltcGw+O1xuICAgIH1cbn1cbiJdfQ==