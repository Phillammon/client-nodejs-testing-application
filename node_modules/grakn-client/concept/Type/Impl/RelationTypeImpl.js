/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("grakn-client/concept/type/impl/RelationTypeImpl", ["require", "exports", "grakn-client/dependencies_internal", "graknlabs-grpc-protocol/protobuf/concept_pb"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.RemoteRelationTypeImpl = exports.RelationTypeImpl = void 0;
    const dependencies_internal_1 = require("grakn-client/dependencies_internal");
    const concept_pb_1 = __importDefault(require("graknlabs-grpc-protocol/protobuf/concept_pb"));
    class RelationTypeImpl extends dependencies_internal_1.ThingTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new RelationTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        asRemote(transaction) {
            return new RemoteRelationTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.RelationTypeImpl = RelationTypeImpl;
    class RemoteRelationTypeImpl extends dependencies_internal_1.RemoteThingTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        asRemote(transaction) {
            return new RemoteRelationTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        create() {
            const method = new concept_pb_1.default.Type.Req().setRelationTypeCreateReq(new concept_pb_1.default.RelationType.Create.Req());
            return this.execute(method).then(res => dependencies_internal_1.RelationImpl.of(res.getRelationTypeCreateRes().getRelation()));
        }
        getRelates(roleLabel) {
            if (roleLabel != null) {
                const method = new concept_pb_1.default.Type.Req().setRelationTypeGetRelatesForRoleLabelReq(new concept_pb_1.default.RelationType.GetRelatesForRoleLabel.Req().setLabel(roleLabel));
                return this.execute(method).then(res => {
                    const getRelatesRes = res.getRelationTypeGetRelatesForRoleLabelRes();
                    if (getRelatesRes.hasRoleType())
                        return dependencies_internal_1.ConceptProtoReader.type(getRelatesRes.getRoleType());
                    else
                        return null;
                });
            }
            return this.typeStream(new concept_pb_1.default.Type.Req().setRelationTypeGetRelatesReq(new concept_pb_1.default.RelationType.GetRelates.Req()), res => res.getRelationTypeGetRelatesRes().getRoleList());
        }
        setRelates(roleLabel, overriddenLabel) {
            return __awaiter(this, void 0, void 0, function* () {
                const setRelatesReq = new concept_pb_1.default.RelationType.SetRelates.Req().setLabel(roleLabel);
                if (overriddenLabel != null)
                    setRelatesReq.setOverriddenLabel(overriddenLabel);
                yield this.execute(new concept_pb_1.default.Type.Req().setRelationTypeSetRelatesReq(setRelatesReq));
            });
        }
        unsetRelates(roleLabel) {
            return __awaiter(this, void 0, void 0, function* () {
                yield this.execute(new concept_pb_1.default.Type.Req()
                    .setRelationTypeUnsetRelatesReq(new concept_pb_1.default.RelationType.UnsetRelates.Req().setLabel(roleLabel)));
            });
        }
        setSupertype(relationType) {
            return super.setSupertype(relationType);
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
    }
    exports.RemoteRelationTypeImpl = RemoteRelationTypeImpl;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVsYXRpb25UeXBlSW1wbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2NvbmNlcHQvdHlwZS9pbXBsL1JlbGF0aW9uVHlwZUltcGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBaUJHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBRUgsOEVBVXdDO0lBRXhDLDZGQUE4RjtJQUU5RixNQUFhLGdCQUFpQixTQUFRLHFDQUFhO1FBQy9DLFlBQXNCLEtBQWEsRUFBRSxNQUFlO1lBQ2hELEtBQUssQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDekIsQ0FBQztRQUVELE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBb0I7WUFDMUIsT0FBTyxJQUFJLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUMzRSxDQUFDO1FBRUQsUUFBUSxDQUFDLFdBQXdCO1lBQzdCLE9BQU8sSUFBSSxzQkFBc0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1FBQ2xGLENBQUM7S0FDSjtJQVpELDRDQVlDO0lBRUQsTUFBYSxzQkFBdUIsU0FBUSwyQ0FBbUI7UUFDM0QsWUFBWSxXQUF3QixFQUFFLEtBQWEsRUFBRSxNQUFlO1lBQ2hFLEtBQUssQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3RDLENBQUM7UUFFRCxRQUFRLENBQUMsV0FBd0I7WUFDN0IsT0FBTyxJQUFJLHNCQUFzQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDbEYsQ0FBQztRQUVELE1BQU07WUFDRixNQUFNLE1BQU0sR0FBRyxJQUFJLG9CQUFZLENBQUMs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LHdEQWdFQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICAgIFRoaW5nVHlwZUltcGwsXG4gICAgUmVtb3RlVGhpbmdUeXBlSW1wbCxcbiAgICBSZWxhdGlvblR5cGUsXG4gICAgUmVtb3RlUmVsYXRpb25UeXBlLFxuICAgIEdyYWtuLFxuICAgIFN0cmVhbSxcbiAgICBSZWxhdGlvbkltcGwsXG4gICAgUm9sZVR5cGVJbXBsLFxuICAgIENvbmNlcHRQcm90b1JlYWRlcixcbn0gZnJvbSBcIi4uLy4uLy4uL2RlcGVuZGVuY2llc19pbnRlcm5hbFwiO1xuaW1wb3J0IFRyYW5zYWN0aW9uID0gR3Jha24uVHJhbnNhY3Rpb247XG5pbXBvcnQgQ29uY2VwdFByb3RvLCB7IFR5cGUgYXMgVHlwZVByb3RvIH0gZnJvbSBcImdyYWtubGFicy1ncnBjLXByb3RvY29sL3Byb3RvYnVmL2NvbmNlcHRfcGJcIjtcblxuZXhwb3J0IGNsYXNzIFJlbGF0aW9uVHlwZUltcGwgZXh0ZW5kcyBUaGluZ1R5cGVJbXBsIGltcGxlbWVudHMgUmVsYXRpb25UeXBlIHtcbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0b3IobGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIHN0YXRpYyBvZih0eXBlUHJvdG86IFR5cGVQcm90byk6IFJlbGF0aW9uVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbGF0aW9uVHlwZUltcGwodHlwZVByb3RvLmdldExhYmVsKCksIHR5cGVQcm90by5nZXRSb290KCkpO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZVJlbGF0aW9uVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZVJlbGF0aW9uVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSlcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSZW1vdGVSZWxhdGlvblR5cGVJbXBsIGV4dGVuZHMgUmVtb3RlVGhpbmdUeXBlSW1wbCBpbXBsZW1lbnRzIFJlbW90ZVJlbGF0aW9uVHlwZSB7XG4gICAgY29uc3RydWN0b3IodHJhbnNhY3Rpb246IFRyYW5zYWN0aW9uLCBsYWJlbDogc3RyaW5nLCBpc1Jvb3Q6IGJvb2xlYW4pIHtcbiAgICAgICAgc3VwZXIodHJhbnNhY3Rpb24sIGxhYmVsLCBpc1Jvb3QpO1xuICAgIH1cblxuICAgIGFzUmVtb3RlKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbik6IFJlbW90ZVJlbGF0aW9uVHlwZUltcGwge1xuICAgICAgICByZXR1cm4gbmV3IFJlbW90ZVJlbGF0aW9uVHlwZUltcGwodHJhbnNhY3Rpb24sIHRoaXMuZ2V0TGFiZWwoKSwgdGhpcy5pc1Jvb3QoKSlcbiAgICB9XG5cbiAgICBjcmVhdGUoKTogUHJvbWlzZTxSZWxhdGlvbkltcGw+IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gbmV3IENvbmNlcHRQcm90by5UeXBlLlJlcSgpLnNldFJlbGF0aW9uVHlwZUNyZWF0ZVJlcShuZXcgQ29uY2VwdFByb3RvLlJlbGF0aW9uVHlwZS5DcmVhdGUuUmVxKCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRlKG1ldGhvZCkudGhlbihyZXMgPT4gUmVsYXRpb25JbXBsLm9mKHJlcy5nZXRSZWxhdGlvblR5cGVDcmVhdGVSZXMoKS5nZXRSZWxhdGlvbigpKSk7XG4gICAgfVxuXG4gICAgZ2V0UmVsYXRlcyhyb2xlTGFiZWw6IHN0cmluZyk6IFByb21pc2U8Um9sZVR5cGVJbXBsPjtcbiAgICBnZXRSZWxhdGVzKCk6IFN0cmVhbTxSb2xlVHlwZUltcGw+O1xuICAgIGdldFJlbGF0ZXMocm9sZUxhYmVsPzogc3RyaW5nKTogUHJvbWlzZTxSb2xlVHlwZUltcGw+IHwgU3RyZWFtPFJvbGVUeXBlSW1wbD4ge1xuICAgICAgICBpZiAocm9sZUxhYmVsICE9IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IG1ldGhvZCA9IG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRSZWxhdGlvblR5cGVHZXRSZWxhdGVzRm9yUm9sZUxhYmVsUmVxKFxuICAgICAgICAgICAgICAgIG5ldyBDb25jZXB0UHJvdG8uUmVsYXRpb25UeXBlLkdldFJlbGF0ZXNGb3JSb2xlTGFiZWwuUmVxKCkuc2V0TGFiZWwocm9sZUxhYmVsKSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5leGVjdXRlKG1ldGhvZCkudGhlbihyZXMgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGdldFJlbGF0ZXNSZXMgPSByZXMuZ2V0UmVsYXRpb25UeXBlR2V0UmVsYXRlc0ZvclJvbGVMYWJlbFJlcygpO1xuICAgICAgICAgICAgICAgIGlmIChnZXRSZWxhdGVzUmVzLmhhc1JvbGVUeXBlKCkpIHJldHVybiBDb25jZXB0UHJvdG9SZWFkZXIudHlwZShnZXRSZWxhdGVzUmVzLmdldFJvbGVUeXBlKCkpIGFzIFJvbGVUeXBlSW1wbDtcbiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy50eXBlU3RyZWFtKFxuICAgICAgICAgICAgbmV3IENvbmNlcHRQcm90by5UeXBlLlJlcSgpLnNldFJlbGF0aW9uVHlwZUdldFJlbGF0ZXNSZXEobmV3IENvbmNlcHRQcm90by5SZWxhdGlvblR5cGUuR2V0UmVsYXRlcy5SZXEoKSksXG4gICAgICAgICAgICByZXMgPT4gcmVzLmdldFJlbGF0aW9uVHlwZUdldFJlbGF0ZXNSZXMoKS5nZXRSb2xlTGlzdCgpKSBhcyBTdHJlYW08Um9sZVR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBzZXRSZWxhdGVzKHJvbGVMYWJlbDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPjtcbiAgICBzZXRSZWxhdGVzKHJvbGVMYWJlbDogc3RyaW5nLCBvdmVycmlkZGVuTGFiZWw6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG4gICAgYXN5bmMgc2V0UmVsYXRlcyhyb2xlTGFiZWw6IHN0cmluZywgb3ZlcnJpZGRlbkxhYmVsPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHNldFJlbGF0ZXNSZXEgPSBuZXcgQ29uY2VwdFByb3RvLlJlbGF0aW9uVHlwZS5TZXRSZWxhdGVzLlJlcSgpLnNldExhYmVsKHJvbGVMYWJlbCk7XG4gICAgICAgIGlmIChvdmVycmlkZGVuTGFiZWwgIT0gbnVsbCkgc2V0UmVsYXRlc1JlcS5zZXRPdmVycmlkZGVuTGFiZWwob3ZlcnJpZGRlbkxhYmVsKTtcbiAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlKG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRSZWxhdGlvblR5cGVTZXRSZWxhdGVzUmVxKHNldFJlbGF0ZXNSZXEpKTtcbiAgICB9XG5cbiAgICBhc3luYyB1bnNldFJlbGF0ZXMocm9sZUxhYmVsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlKG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKVxuICAgICAgICAgICAgLnNldFJlbGF0aW9uVHlwZVVuc2V0UmVsYXRlc1JlcShuZXcgQ29uY2VwdFByb3RvLlJlbGF0aW9uVHlwZS5VbnNldFJlbGF0ZXMuUmVxKCkuc2V0TGFiZWwocm9sZUxhYmVsKSkpO1xuICAgIH1cblxuICAgIHNldFN1cGVydHlwZShyZWxhdGlvblR5cGU6IFJlbGF0aW9uVHlwZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuc2V0U3VwZXJ0eXBlKHJlbGF0aW9uVHlwZSk7XG4gICAgfVxuXG4gICAgZ2V0U3VwZXJ0eXBlKCk6IFByb21pc2U8UmVsYXRpb25UeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlKCkgYXMgUHJvbWlzZTxSZWxhdGlvblR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdXBlcnR5cGVzKCk6IFN0cmVhbTxSZWxhdGlvblR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdXBlcnR5cGVzKCkgYXMgU3RyZWFtPFJlbGF0aW9uVHlwZUltcGw+O1xuICAgIH1cblxuICAgIGdldFN1YnR5cGVzKCk6IFN0cmVhbTxSZWxhdGlvblR5cGVJbXBsPiB7XG4gICAgICAgIHJldHVybiBzdXBlci5nZXRTdWJ0eXBlcygpIGFzIFN0cmVhbTxSZWxhdGlvblR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRJbnN0YW5jZXMoKTogU3RyZWFtPFJlbGF0aW9uSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0SW5zdGFuY2VzKCkgYXMgU3RyZWFtPFJlbGF0aW9uSW1wbD47XG4gICAgfVxufVxuIl19