/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
(function (factory) {
    if (typeof module === "object" && typeof module.exports === "object") {
        var v = factory(require, exports);
        if (v !== undefined) module.exports = v;
    }
    else if (typeof define === "function" && define.amd) {
        define("grakn-client/concept/type/impl/RelationTypeImpl", ["require", "exports", "grakn-client/dependencies_internal", "graknlabs-protocol/protobuf/concept_pb"], factory);
    }
})(function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.RemoteRelationTypeImpl = exports.RelationTypeImpl = void 0;
    const dependencies_internal_1 = require("grakn-client/dependencies_internal");
    const concept_pb_1 = __importDefault(require("graknlabs-protocol/protobuf/concept_pb"));
    class RelationTypeImpl extends dependencies_internal_1.ThingTypeImpl {
        constructor(label, isRoot) {
            super(label, isRoot);
        }
        static of(typeProto) {
            return new RelationTypeImpl(typeProto.getLabel(), typeProto.getRoot());
        }
        asRemote(transaction) {
            return new RemoteRelationTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
    }
    exports.RelationTypeImpl = RelationTypeImpl;
    class RemoteRelationTypeImpl extends dependencies_internal_1.RemoteThingTypeImpl {
        constructor(transaction, label, isRoot) {
            super(transaction, label, isRoot);
        }
        asRemote(transaction) {
            return new RemoteRelationTypeImpl(transaction, this.getLabel(), this.isRoot());
        }
        create() {
            const method = new concept_pb_1.default.Type.Req().setRelationTypeCreateReq(new concept_pb_1.default.RelationType.Create.Req());
            return this.execute(method).then(res => dependencies_internal_1.RelationImpl.of(res.getRelationTypeCreateRes().getRelation()));
        }
        getRelates(roleLabel) {
            if (roleLabel != null) {
                const method = new concept_pb_1.default.Type.Req().setRelationTypeGetRelatesForRoleLabelReq(new concept_pb_1.default.RelationType.GetRelatesForRoleLabel.Req().setLabel(roleLabel));
                return this.execute(method).then(res => {
                    const getRelatesRes = res.getRelationTypeGetRelatesForRoleLabelRes();
                    if (getRelatesRes.hasRoleType())
                        return dependencies_internal_1.ConceptProtoReader.type(getRelatesRes.getRoleType());
                    else
                        return null;
                });
            }
            return this.typeStream(new concept_pb_1.default.Type.Req().setRelationTypeGetRelatesReq(new concept_pb_1.default.RelationType.GetRelates.Req()), res => res.getRelationTypeGetRelatesRes().getRoleList());
        }
        setRelates(roleLabel, overriddenLabel) {
            return __awaiter(this, void 0, void 0, function* () {
                const setRelatesReq = new concept_pb_1.default.RelationType.SetRelates.Req().setLabel(roleLabel);
                if (overriddenLabel != null)
                    setRelatesReq.setOverriddenLabel(overriddenLabel);
                yield this.execute(new concept_pb_1.default.Type.Req().setRelationTypeSetRelatesReq(setRelatesReq));
            });
        }
        unsetRelates(roleLabel) {
            return __awaiter(this, void 0, void 0, function* () {
                yield this.execute(new concept_pb_1.default.Type.Req()
                    .setRelationTypeUnsetRelatesReq(new concept_pb_1.default.RelationType.UnsetRelates.Req().setLabel(roleLabel)));
            });
        }
        setSupertype(relationType) {
            return super.setSupertype(relationType);
        }
        getSupertype() {
            return super.getSupertype();
        }
        getSupertypes() {
            return super.getSupertypes();
        }
        getSubtypes() {
            return super.getSubtypes();
        }
        getInstances() {
            return super.getInstances();
        }
    }
    exports.RemoteRelationTypeImpl = RemoteRelationTypeImpl;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVsYXRpb25UeXBlSW1wbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2NvbmNlcHQvdHlwZS9pbXBsL1JlbGF0aW9uVHlwZUltcGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBaUJHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBRUgsOEVBVXdDO0lBRXhDLHdGQUF5RjtJQUV6RixNQUFhLGdCQUFpQixTQUFRLHFDQUFhO1FBQy9DLFlBQXNCLEtBQWEsRUFBRSxNQUFlO1lBQ2hELEtBQUssQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDekIsQ0FBQztRQUVELE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBb0I7WUFDMUIsT0FBTyxJQUFJLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztRQUMzRSxDQUFDO1FBRUQsUUFBUSxDQUFDLFdBQXdCO1lBQzdCLE9BQU8sSUFBSSxzQkFBc0IsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1FBQ2xGLENBQUM7S0FDSjtJQVpELDRDQVlDO0lBRUQsTUFBYSxzQkFBdUIsU0FBUSwyQ0FBbUI7UUFDM0QsWUFBWSxXQUF3QixFQUFFLEtBQWEsRUFBRSxNQUFlO1lBQ2hFLEtBQUssQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3RDLENBQUM7UUFFRCxRQUFRLENBQUMsV0FBd0I7WUFDN0IsT0FBTyxJQUFJLHNCQUFzQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUE7UUFDbEYsQ0FBQztRQUVELE1BQU07WUFDRixNQUFNLE1BQU0sR0FBRyxJQUFJLG9CQUFZLENBQUMs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LHdEQWdFQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBMaWNlbnNlZCB0byB0aGUgQXBhY2hlIFNvZnR3YXJlIEZvdW5kYXRpb24gKEFTRikgdW5kZXIgb25lXG4gKiBvciBtb3JlIGNvbnRyaWJ1dG9yIGxpY2Vuc2UgYWdyZWVtZW50cy4gIFNlZSB0aGUgTk9USUNFIGZpbGVcbiAqIGRpc3RyaWJ1dGVkIHdpdGggdGhpcyB3b3JrIGZvciBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXG4gKiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4gIFRoZSBBU0YgbGljZW5zZXMgdGhpcyBmaWxlXG4gKiB0byB5b3UgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlXG4gKiBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2VcbiAqIHdpdGggdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuXG4gKiBcIkFTIElTXCIgQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxuICogS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4gIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlXG4gKiBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zXG4gKiB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICAgIFRoaW5nVHlwZUltcGwsXG4gICAgUmVtb3RlVGhpbmdUeXBlSW1wbCxcbiAgICBSZWxhdGlvblR5cGUsXG4gICAgUmVtb3RlUmVsYXRpb25UeXBlLFxuICAgIEdyYWtuLFxuICAgIFN0cmVhbSxcbiAgICBSZWxhdGlvbkltcGwsXG4gICAgUm9sZVR5cGVJbXBsLFxuICAgIENvbmNlcHRQcm90b1JlYWRlcixcbn0gZnJvbSBcIi4uLy4uLy4uL2RlcGVuZGVuY2llc19pbnRlcm5hbFwiO1xuaW1wb3J0IFRyYW5zYWN0aW9uID0gR3Jha24uVHJhbnNhY3Rpb247XG5pbXBvcnQgQ29uY2VwdFByb3RvLCB7IFR5cGUgYXMgVHlwZVByb3RvIH0gZnJvbSBcImdyYWtubGFicy1wcm90b2NvbC9wcm90b2J1Zi9jb25jZXB0X3BiXCI7XG5cbmV4cG9ydCBjbGFzcyBSZWxhdGlvblR5cGVJbXBsIGV4dGVuZHMgVGhpbmdUeXBlSW1wbCBpbXBsZW1lbnRzIFJlbGF0aW9uVHlwZSB7XG4gICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKGxhYmVsOiBzdHJpbmcsIGlzUm9vdDogYm9vbGVhbikge1xuICAgICAgICBzdXBlcihsYWJlbCwgaXNSb290KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgb2YodHlwZVByb3RvOiBUeXBlUHJvdG8pOiBSZWxhdGlvblR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWxhdGlvblR5cGVJbXBsKHR5cGVQcm90by5nZXRMYWJlbCgpLCB0eXBlUHJvdG8uZ2V0Um9vdCgpKTtcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVSZWxhdGlvblR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVSZWxhdGlvblR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpXG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUmVtb3RlUmVsYXRpb25UeXBlSW1wbCBleHRlbmRzIFJlbW90ZVRoaW5nVHlwZUltcGwgaW1wbGVtZW50cyBSZW1vdGVSZWxhdGlvblR5cGUge1xuICAgIGNvbnN0cnVjdG9yKHRyYW5zYWN0aW9uOiBUcmFuc2FjdGlvbiwgbGFiZWw6IHN0cmluZywgaXNSb290OiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHRyYW5zYWN0aW9uLCBsYWJlbCwgaXNSb290KTtcbiAgICB9XG5cbiAgICBhc1JlbW90ZSh0cmFuc2FjdGlvbjogVHJhbnNhY3Rpb24pOiBSZW1vdGVSZWxhdGlvblR5cGVJbXBsIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVSZWxhdGlvblR5cGVJbXBsKHRyYW5zYWN0aW9uLCB0aGlzLmdldExhYmVsKCksIHRoaXMuaXNSb290KCkpXG4gICAgfVxuXG4gICAgY3JlYXRlKCk6IFByb21pc2U8UmVsYXRpb25JbXBsPiB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRSZWxhdGlvblR5cGVDcmVhdGVSZXEobmV3IENvbmNlcHRQcm90by5SZWxhdGlvblR5cGUuQ3JlYXRlLlJlcSgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXhlY3V0ZShtZXRob2QpLnRoZW4ocmVzID0+IFJlbGF0aW9uSW1wbC5vZihyZXMuZ2V0UmVsYXRpb25UeXBlQ3JlYXRlUmVzKCkuZ2V0UmVsYXRpb24oKSkpO1xuICAgIH1cblxuICAgIGdldFJlbGF0ZXMocm9sZUxhYmVsOiBzdHJpbmcpOiBQcm9taXNlPFJvbGVUeXBlSW1wbD47XG4gICAgZ2V0UmVsYXRlcygpOiBTdHJlYW08Um9sZVR5cGVJbXBsPjtcbiAgICBnZXRSZWxhdGVzKHJvbGVMYWJlbD86IHN0cmluZyk6IFByb21pc2U8Um9sZVR5cGVJbXBsPiB8IFN0cmVhbTxSb2xlVHlwZUltcGw+IHtcbiAgICAgICAgaWYgKHJvbGVMYWJlbCAhPSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBtZXRob2QgPSBuZXcgQ29uY2VwdFByb3RvLlR5cGUuUmVxKCkuc2V0UmVsYXRpb25UeXBlR2V0UmVsYXRlc0ZvclJvbGVMYWJlbFJlcShcbiAgICAgICAgICAgICAgICBuZXcgQ29uY2VwdFByb3RvLlJlbGF0aW9uVHlwZS5HZXRSZWxhdGVzRm9yUm9sZUxhYmVsLlJlcSgpLnNldExhYmVsKHJvbGVMYWJlbCkpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhlY3V0ZShtZXRob2QpLnRoZW4ocmVzID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBnZXRSZWxhdGVzUmVzID0gcmVzLmdldFJlbGF0aW9uVHlwZUdldFJlbGF0ZXNGb3JSb2xlTGFiZWxSZXMoKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2V0UmVsYXRlc1Jlcy5oYXNSb2xlVHlwZSgpKSByZXR1cm4gQ29uY2VwdFByb3RvUmVhZGVyLnR5cGUoZ2V0UmVsYXRlc1Jlcy5nZXRSb2xlVHlwZSgpKSBhcyBSb2xlVHlwZUltcGw7XG4gICAgICAgICAgICAgICAgZWxzZSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZVN0cmVhbShcbiAgICAgICAgICAgIG5ldyBDb25jZXB0UHJvdG8uVHlwZS5SZXEoKS5zZXRSZWxhdGlvblR5cGVHZXRSZWxhdGVzUmVxKG5ldyBDb25jZXB0UHJvdG8uUmVsYXRpb25UeXBlLkdldFJlbGF0ZXMuUmVxKCkpLFxuICAgICAgICAgICAgcmVzID0+IHJlcy5nZXRSZWxhdGlvblR5cGVHZXRSZWxhdGVzUmVzKCkuZ2V0Um9sZUxpc3QoKSkgYXMgU3RyZWFtPFJvbGVUeXBlSW1wbD47XG4gICAgfVxuXG4gICAgc2V0UmVsYXRlcyhyb2xlTGFiZWw6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG4gICAgc2V0UmVsYXRlcyhyb2xlTGFiZWw6IHN0cmluZywgb3ZlcnJpZGRlbkxhYmVsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+O1xuICAgIGFzeW5jIHNldFJlbGF0ZXMocm9sZUxhYmVsOiBzdHJpbmcsIG92ZXJyaWRkZW5MYWJlbD86IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZXRSZWxhdGVzUmVxID0gbmV3IENvbmNlcHRQcm90by5SZWxhdGlvblR5cGUuU2V0UmVsYXRlcy5SZXEoKS5zZXRMYWJlbChyb2xlTGFiZWwpO1xuICAgICAgICBpZiAob3ZlcnJpZGRlbkxhYmVsICE9IG51bGwpIHNldFJlbGF0ZXNSZXEuc2V0T3ZlcnJpZGRlbkxhYmVsKG92ZXJyaWRkZW5MYWJlbCk7XG4gICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZShuZXcgQ29uY2VwdFByb3RvLlR5cGUuUmVxKCkuc2V0UmVsYXRpb25UeXBlU2V0UmVsYXRlc1JlcShzZXRSZWxhdGVzUmVxKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgdW5zZXRSZWxhdGVzKHJvbGVMYWJlbDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMuZXhlY3V0ZShuZXcgQ29uY2VwdFByb3RvLlR5cGUuUmVxKClcbiAgICAgICAgICAgIC5zZXRSZWxhdGlvblR5cGVVbnNldFJlbGF0ZXNSZXEobmV3IENvbmNlcHRQcm90by5SZWxhdGlvblR5cGUuVW5zZXRSZWxhdGVzLlJlcSgpLnNldExhYmVsKHJvbGVMYWJlbCkpKTtcbiAgICB9XG5cbiAgICBzZXRTdXBlcnR5cGUocmVsYXRpb25UeXBlOiBSZWxhdGlvblR5cGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnNldFN1cGVydHlwZShyZWxhdGlvblR5cGUpO1xuICAgIH1cblxuICAgIGdldFN1cGVydHlwZSgpOiBQcm9taXNlPFJlbGF0aW9uVHlwZUltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldFN1cGVydHlwZSgpIGFzIFByb21pc2U8UmVsYXRpb25UeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0U3VwZXJ0eXBlcygpOiBTdHJlYW08UmVsYXRpb25UeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VwZXJ0eXBlcygpIGFzIFN0cmVhbTxSZWxhdGlvblR5cGVJbXBsPjtcbiAgICB9XG5cbiAgICBnZXRTdWJ0eXBlcygpOiBTdHJlYW08UmVsYXRpb25UeXBlSW1wbD4ge1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0U3VidHlwZXMoKSBhcyBTdHJlYW08UmVsYXRpb25UeXBlSW1wbD47XG4gICAgfVxuXG4gICAgZ2V0SW5zdGFuY2VzKCk6IFN0cmVhbTxSZWxhdGlvbkltcGw+IHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmdldEluc3RhbmNlcygpIGFzIFN0cmVhbTxSZWxhdGlvbkltcGw+O1xuICAgIH1cbn1cbiJdfQ==